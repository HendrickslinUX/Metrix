<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Metrix HardLine ‚Äî User Dashboard</title>

<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;600;700&display=swap" rel="stylesheet">

<style>
/* ===== BASE ===== */
body {
  margin:0;
  font-family:'DM Sans',sans-serif;
  background:#ff7a18;
  color:#111;
}

header {
  background:#0b0b0b;
  color:white;
  padding:1rem;
  display:flex;
  justify-content:space-between;
  align-items:center;
}

button {
  cursor:pointer;
  border:none;
  border-radius:8px;
  padding:.5rem 1rem;
  font-weight:700;
}

#menuBtn { background:#ff9800; }
#logoutBtn { background:#e53935; color:white; }

/* ===== MENU ===== */
.menu-drawer {
  position:fixed;
  top:0;
  right:-100%;
  width:280px;
  height:100%;
  background:#0b0b0b;
  color:white;
  padding:1.5rem;
  transition:right .3s ease;
  z-index:999;
}

.menu-drawer.open { right:0; }

.menu-drawer h2 { margin-top:0; }
.menu-drawer p { font-size:.9rem; }
.menu-drawer button { width:100%; margin-top:1rem; }

/* ===== STATS ===== */
.stats {
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(140px,1fr));
  gap:1rem;
  padding:1rem;
}

.stat {
  background:#ffe0b2;
  border-radius:12px;
  padding:1rem;
  text-align:center;
  box-shadow:0 4px 10px rgba(0,0,0,.2);
}

/* ===== CALENDAR ===== */
.calendar-controls {
  display:flex;
  justify-content:center;
  gap:1rem;
  padding:1rem;
}

.calendar {
  display:grid;
  grid-template-columns:repeat(7,1fr);
  gap:6px;
  padding:1rem;
}

.day {
  background:#fff3e0;
  min-height:90px;
  border-radius:12px;
  padding:.4rem;
  box-shadow:0 3px 6px rgba(0,0,0,.2);
}

.day header {
  font-size:.8rem;
  font-weight:700;
  background:none;
  color:#111;
  padding:0;
}

.task {
  margin-top:4px;
  padding:4px 6px;
  border-radius:6px;
  font-size:.75rem;
  color:white;
  font-weight:700;
}

.Softy { background:#607d8b; }
.GrindMode { background:#ff9800; }
.HardLine { background:#d32f2f; }

/* ===== MODAL ===== */
.modal {
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.6);
  display:none;
  justify-content:center;
  align-items:center;
  z-index:1000;
}

.modal-content {
  background:white;
  padding:1.5rem;
  border-radius:12px;
  width:300px;
}

.modal-content input,
.modal-content select,
.modal-content button {
  width:100%;
  margin-top:.6rem;
  padding:.5rem;
}
</style>
</head>

<body>

<script>
/* üîê AUTH CHECK ‚Äî MUST BE FIRST */
const loggedInUser = JSON.parse(localStorage.getItem("loggedInUser"));
if (!loggedInUser) window.location.href = "userlogin.html";
</script>

<header>
  <h1>Metrix HardLine</h1>
  <div>
    <button id="menuBtn">Menu</button>
    <button id="logoutBtn">Logout</button>
  </div>
</header>

<div class="menu-drawer" id="menu">
  <h2>Account</h2>
  <p><strong>Username:</strong> <span id="uName"></span></p>
  <p><strong>Email:</strong> <span id="uEmail"></span></p>
  <label>
    <input type="checkbox" id="notifToggle" checked>
    Coach notifications
  </label>
  <button id="menuClose">Close</button>
  <button id="menuLogout">Logout</button>
</div>

<section class="stats">
  <div class="stat">Total<br><span id="total">0</span></div>
  <div class="stat">Completed<br><span id="completed">0</span></div>
  <div class="stat">Missed<br><span id="missed">0</span></div>
</section>

<div class="calendar-controls">
  <button id="prevMonth">‚óÄ</button>
  <strong id="monthLabel"></strong>
  <button id="nextMonth">‚ñ∂</button>
</div>

<section class="calendar" id="calendar"></section>

<!-- TASK MODAL -->
<div class="modal" id="taskModal">
  <div class="modal-content">
    <h3>Create Task</h3>
    <input id="taskTitle" placeholder="Task name">
    <select id="taskIntensity">
      <option>Softy</option>
      <option>GrindMode</option>
      <option>HardLine</option>
    </select>
    <button id="saveTask">Save</button>
  </div>
</div>

<script>
/* ===== USER INFO ===== */
uName.textContent = loggedInUser.username;
uEmail.textContent = loggedInUser.email;

/* ===== MENU ===== */
menuBtn.onclick = () => menu.classList.add("open");
menuClose.onclick = () => menu.classList.remove("open");
menuLogout.onclick = logout;
logoutBtn.onclick = logout;

function logout() {
  localStorage.removeItem("loggedInUser");
  window.location.href = "userlogin.html";
}

/* ===== CALENDAR LOGIC ===== */
let currentDate = new Date();
let tasks = JSON.parse(localStorage.getItem("tasks")) || [];
let selectedDate = "";

function renderCalendar() {
  calendar.innerHTML = "";
  const year = currentDate.getFullYear();
  const month = currentDate.getMonth();

  monthLabel.textContent =
    currentDate.toLocaleString("default",{month:"long"}) + " " + year;

  const firstDay = new Date(year, month, 1).getDay();
  const daysInMonth = new Date(year, month + 1, 0).getDate();

  for (let i=0;i<firstDay;i++) calendar.appendChild(document.createElement("div"));

  for (let d=1; d<=daysInMonth; d++) {
    const dateStr = `${year}-${String(month+1).padStart(2,"0")}-${String(d).padStart(2,"0")}`;
    const day = document.createElement("div");
    day.className="day";
    day.innerHTML = `<header>${d}</header>`;
    day.onclick = () => openModal(dateStr);

    tasks.filter(t=>t.date===dateStr).forEach(t=>{
      const el=document.createElement("div");
      el.className=`task ${t.intensity}`;
      el.textContent=t.title;
      day.appendChild(el);
    });

    calendar.appendChild(day);
  }

  updateStats();
}

prevMonth.onclick = () => { currentDate.setMonth(currentDate.getMonth()-1); renderCalendar(); }
nextMonth.onclick = () => { currentDate.setMonth(currentDate.getMonth()+1); renderCalendar(); }

/* ===== TASK MODAL ===== */
function openModal(date){
  selectedDate=date;
  taskModal.style.display="flex";
}

saveTask.onclick = () => {
  if(!taskTitle.value) return;
  tasks.push({ title:taskTitle.value, intensity:taskIntensity.value, date:selectedDate });
  localStorage.setItem("tasks",JSON.stringify(tasks));
  taskModal.style.display="none";
  taskTitle.value="";
  renderCalendar();
};

/* ===== STATS ===== */
function updateStats(){
  total.textContent = tasks.length;
  completed.textContent = "‚Äî";
  missed.textContent = "‚Äî";
}

renderCalendar();
</script>

</body>
</html>






